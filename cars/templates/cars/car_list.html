{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container my-5">
  <!-- All Cars -->
  <h2 class="text-center mb-4">Explore All Cars</h2>
  <div class="row g-4">
    {% for car in cars %}
      <div class="col-md-4 col-lg-3">
        <div class="card shadow-sm border-0 h-100 car-card">
          
          <!-- Image links to detail -->
          <a href="{% url 'cars:car_detail' car.slug %}">
            <img src="{{ car.image.url }}" class="card-img-top" alt="{{ car.title }}">
          </a>

          <div class="card-body d-flex flex-column">
            <!-- Title links to detail -->
            <h6 class="fw-bold text-danger mb-1">
              <a href="{% url 'cars:car_detail' car.slug %}" 
                 class="text-decoration-none text-dark">
                {{ car.brand }} {{ car.model }}
              </a>
            </h6>
            <p class="text-muted small mb-2">
              {{ car.year }} â€¢ {{ car.engine_size }} {{ car.transmission }}
            </p>

            <!-- Specs -->
            <ul class="list-unstyled small mb-3">
              <li><i class="bi bi-fuel-pump"></i> {{ car.fuel_type }}</li>
              <li><i class="bi bi-speedometer2"></i> {{ car.mileage }} km</li>
              <li><i class="bi bi-credit-card-2-back"></i> License included</li>
              <li><i class="bi bi-truck"></i> Import approved</li>
            </ul>

            <!-- Price + Compare button -->
            <div class="mt-auto">
              {% if car.price %}
                <p class="fw-bold text-danger mb-2">
                  Ksh {{ car.price|floatformat:0 }}
                </p>
              {% else %}
                <p class="fw-bold text-danger mb-2">Price on request</p>
              {% endif %}

              <div class="d-flex justify-content-between">
                <a href="{% url 'cars:car_detail' car.slug %}" 
                   class="btn btn-danger btn-sm rounded-pill">
                   View
                </a>
                <form method="post" action="{% url 'cars:add_to_compare' car.slug %}">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-outline-primary btn-sm">+ Compare</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-center">No cars available right now.</p>
    {% endfor %}
  </div>

  <!-- Brands -->
  <div class="text-center mt-5">
    <h1 class="mb-4">Our Brands</h1>
  </div>
  <div class="brand-logos d-flex justify-content-center flex-wrap gap-4 mb-5">
    {% for brand in brands %}
      <a href="{% url 'cars:brand_cars' brand.slug %}" class="text-center text-decoration-none">
        <div class="logo-circle shadow-sm">
          <img src="{{ brand.logo.url }}" alt="{{ brand.name }}">
        </div>
        <small class="d-block mt-2 text-muted">{{ brand.name }}</small>
      </a>
    {% endfor %}
  </div>
</div>

<style>
  .logo-circle {
    width: 70px;
    height: 70px;
    background: #fff;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .logo-circle img {
    max-width: 50px;
    max-height: 50px;
    object-fit: contain;
  }
  .logo-circle:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  }
  .car-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border-radius: 15px;
    overflow: hidden;
  }
  .car-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  }
  .car-card img {
    height: 200px;
    object-fit: cover;
  }
</style>
{% endblock %}
